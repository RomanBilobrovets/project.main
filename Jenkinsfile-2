pipeline { // задаем тон groovy, даем понять что здесь у нас шаги пайплайна
    agent any // если у нас есть какие то jenkins агенты специально для Ansible мы можем их указать здесь, у меня только один агент, поэтому я поставлю any
   
    environment {
        ANS_KEY = credentials("ansible_key")
    }
    stages { // здесь определяем какие шаги в пайплайне
        stage('Deploy') { // наш деплой
            steps { // определяем шаги уже самого стейджа
                sh 'ansible --version' // выводим версию Ansible, команда sh просто выполнит скрипт из консоли
                sh 'ls'
                sh 'pwd' 
                sh 'ls ansible'
                sh 'echo ${ANS_KEY}'
                sh 'echo ${ANS_KEY} > ./ansible/vault_pass.txt'
                sh 'ansible-playbook ansible/playbook3.yml'
            }
        }
    }
}
