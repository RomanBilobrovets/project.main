#!/usr/bin/env groovy

pipeline { // задаем тон groovy, даем понять что здесь у нас шаги пайплайна
    agent any // если у нас есть какие то jenkins агенты специально для Ansible мы можем их указать здесь, у меня только один агент, поэтому я поставлю any
   
    environment {
        ANS_PATH = "/home/ubuntu/ansible"
    }
    stages { // здесь определяем какие шаги в пайплайне
        stage("Git Checkout"){
            steps {
                sh 'git clone https://github.com/RomanBilobrovets/project.main.git'
        }
      }
        
        
        stage('Deploy') { // наш деплой
            steps { // определяем шаги уже самого стейджа
                sh 'ansible --version' // выводим версию Ansible, команда sh просто выполнит скрипт из консоли
                sh 'ansible-playbook playbook3.yml'
                // sh ('ansible-playbook -vvvvv -i environments/teal_${ENVIRONMENT} playbooks/yourplaybook.yml -e  --vault-password-file ./.vault_pass.txt')
                }
            }
        }
    }