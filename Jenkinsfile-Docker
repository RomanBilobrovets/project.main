#!/usr/bin/env groovy

pipeline { 
    agent any
    stages {
        stage('Build and Push Image') {
            steps { 
                sh 'aws ecr get-login-password --region eu-central-1 | docker login --username AWS --password-stdin 519637832355.dkr.ecr.eu-central-1.amazonaws.com'
                sh 'docker build -t roman/node-web-app'
                sh 'docker tag'
                sh 'docker push'
                sh 'cd docker'
                sh 'docker run -p 49160:8080 -d roman/node-web-app'
            }
                }
    }
    
}